function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

/* eslint-env jasmine */

var _specHelpers = require('./../spec-helpers');

var _libMain = require('./../../lib/main');

var _libMain2 = _interopRequireDefault(_libMain);

'use babel';

describe('go-get service provider', function () {
  beforeEach(function () {
    _specHelpers.lifecycle.setup();
    _libMain2['default'].activate();
  });

  afterEach(function () {
    _specHelpers.lifecycle.teardown();
    _libMain2['default'].deactivate();
  });

  describe('the provider', function () {
    it('is truthy', function () {
      expect(_libMain2['default'].provideGoGet).toBeDefined();
      expect(_libMain2['default'].provideGoGet()).toBeTruthy();
    });
  });

  describe('the 2.0.0 provider', function () {
    it('is truthy', function () {
      expect(_libMain2['default'].provideGoGet).toBeDefined();
      expect(_libMain2['default'].provideGoGet()).toBeTruthy();
    });

    it('has a get function', function () {
      expect(_libMain2['default'].provideGoGet().get).toBeDefined();
    });

    it('has a register function', function () {
      expect(_libMain2['default'].provideGoGet().register).toBeDefined();
    });

    describe('register()', function () {
      var manager = undefined;
      var provider = undefined;
      beforeEach(function () {
        provider = _libMain2['default'].provideGoGet();
        manager = _libMain2['default'].getservice.getmanager;
        expect(manager).toBeTruthy();
        expect(manager.packages).toBeTruthy();
        expect(manager.packages.size).toBe(0);
      });

      it('registers a package', function () {
        provider.register('github.com/mdempsky/gocode');
        expect(manager.packages.size).toBe(1);
        provider.register('github.com/mdempsky/gocode');
        expect(manager.packages.size).toBe(1);
      });

      it('registers the same package multiple times', function () {
        provider.register('github.com/mdempsky/gocode');
        expect(manager.packages.size).toBe(1);
        provider.register('github.com/mdempsky/gocode');
        expect(manager.packages.size).toBe(1);
        provider.register('github.com/mdempsky/gocode');
        expect(manager.packages.size).toBe(1);
      });

      it('allows a package registration to be disposed', function () {
        var registration = provider.register('github.com/mdempsky/gocode');
        expect(registration).toBeTruthy();
        expect(registration.dispose).toBeDefined();
        expect(manager.packages.size).toBe(1);
        registration.dispose();
        expect(manager.packages.size).toBe(0);
      });

      it('dispose is aware of the number of package registrations', function () {
        var registration1 = provider.register('github.com/mdempsky/gocode');
        expect(registration1).toBeTruthy();
        expect(registration1.dispose).toBeDefined();
        expect(manager.packages.size).toBe(1);
        var registration2 = provider.register('github.com/mdempsky/gocode');
        expect(registration2).toBeTruthy();
        expect(registration2.dispose).toBeDefined();
        expect(manager.packages.size).toBe(1);
        registration1.dispose();
        expect(manager.packages.size).toBe(1);
        registration2.dispose();
        expect(manager.packages.size).toBe(0);
        registration1.dispose();
        registration2.dispose();
        expect(manager.packages.size).toBe(0);
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL215dWdhLy5hdG9tL3BhY2thZ2VzL2dvLXBsdXMvc3BlYy9nZXQvcHJvdmlkZXItc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OzJCQUcwQixtQkFBbUI7O3VCQUN0QixrQkFBa0I7Ozs7QUFKekMsV0FBVyxDQUFBOztBQU1YLFFBQVEsQ0FBQyx5QkFBeUIsRUFBRSxZQUFNO0FBQ3hDLFlBQVUsQ0FBQyxZQUFNO0FBQ2YsMkJBQVUsS0FBSyxFQUFFLENBQUE7QUFDakIseUJBQVcsUUFBUSxFQUFFLENBQUE7R0FDdEIsQ0FBQyxDQUFBOztBQUVGLFdBQVMsQ0FBQyxZQUFNO0FBQ2QsMkJBQVUsUUFBUSxFQUFFLENBQUE7QUFDcEIseUJBQVcsVUFBVSxFQUFFLENBQUE7R0FDeEIsQ0FBQyxDQUFBOztBQUVGLFVBQVEsQ0FBQyxjQUFjLEVBQUUsWUFBTTtBQUM3QixNQUFFLENBQUMsV0FBVyxFQUFFLFlBQU07QUFDcEIsWUFBTSxDQUFDLHFCQUFXLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO0FBQzdDLFlBQU0sQ0FBQyxxQkFBVyxZQUFZLEVBQUUsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFBO0tBQy9DLENBQUMsQ0FBQTtHQUNILENBQUMsQ0FBQTs7QUFFRixVQUFRLENBQUMsb0JBQW9CLEVBQUUsWUFBTTtBQUNuQyxNQUFFLENBQUMsV0FBVyxFQUFFLFlBQU07QUFDcEIsWUFBTSxDQUFDLHFCQUFXLFlBQVksQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFBO0FBQzdDLFlBQU0sQ0FBQyxxQkFBVyxZQUFZLEVBQUUsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFBO0tBQy9DLENBQUMsQ0FBQTs7QUFFRixNQUFFLENBQUMsb0JBQW9CLEVBQUUsWUFBTTtBQUM3QixZQUFNLENBQUMscUJBQVcsWUFBWSxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7S0FDcEQsQ0FBQyxDQUFBOztBQUVGLE1BQUUsQ0FBQyx5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Q0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUNyQyxZQUFJLGFBQWEsR0FBRyxRQUFRLENBQUMsUUFBUSxDQUFDLDRCQUE0QixDQUFDLENBQUE7QUFDbkUsY0FBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFBO0FBQ2xDLGNBQU0sQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7QUFDM0MsY0FBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3JDLHFCQUFhLENBQUMsT0FBTyxFQUFFLENBQUE7QUFDdkIsY0FBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3JDLHFCQUFhLENBQUMsT0FBTyxFQUFFLENBQUE7QUFDdkIsY0FBTSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3JDLHFCQUFhLENBQUMsT0FBTyxFQUFFLENBQUE7QUFDdkIscUJBQWEsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtBQUN2QixjQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7T0FDdEMsQ0FBQyxDQUFBO0tBQ0gsQ0FBQyxDQUFBO0dBQ0gsQ0FBQyxDQUFBO0NBQ0gsQ0FBQyxDQUFBIiwiZmlsZSI6Ii9ob21lL215dWdhLy5hdG9tL3BhY2thZ2VzL2dvLXBsdXMvc3BlYy9nZXQvcHJvdmlkZXItc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnXG4vKiBlc2xpbnQtZW52IGphc21pbmUgKi9cblxuaW1wb3J0IHsgbGlmZWN5Y2xlIH0gZnJvbSAnLi8uLi9zcGVjLWhlbHBlcnMnXG5pbXBvcnQgbWFpbk1vZHVsZSBmcm9tICcuLy4uLy4uL2xpYi9tYWluJ1xuXG5kZXNjcmliZSgnZ28tZ2V0IHNlcnZpY2UgcHJvdmlkZXInLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGxpZmVjeWNsZS5zZXR1cCgpXG4gICAgbWFpbk1vZHVsZS5hY3RpdmF0ZSgpXG4gIH0pXG5cbiAgYWZ0ZXJFYWNoKCgpID0+IHtcbiAgICBsaWZlY3ljbGUudGVhcmRvd24oKVxuICAgIG1haW5Nb2R1bGUuZGVhY3RpdmF0ZSgpXG4gIH0pXG5cbiAgZGVzY3JpYmUoJ3RoZSBwcm92aWRlcicsICgpID0+IHtcbiAgICBpdCgnaXMgdHJ1dGh5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KG1haW5Nb2R1bGUucHJvdmlkZUdvR2V0KS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QobWFpbk1vZHVsZS5wcm92aWRlR29HZXQoKSkudG9CZVRydXRoeSgpXG4gICAgfSlcbiAgfSlcblxuICBkZXNjcmliZSgndGhlIDIuMC4wIHByb3ZpZGVyJywgKCkgPT4ge1xuICAgIGl0KCdpcyB0cnV0aHknLCAoKSA9PiB7XG4gICAgICBleHBlY3QobWFpbk1vZHVsZS5wcm92aWRlR29HZXQpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChtYWluTW9kdWxlLnByb3ZpZGVHb0dldCgpKS50b0JlVHJ1dGh5KClcbiAgICB9KVxuXG4gICAgaXQoJ2hhcyBhIGdldCBmdW5jdGlvbicsICgpID0+IHtcbiAgICAgIGV4cGVjdChtYWluTW9kdWxlLnByb3ZpZGVHb0dldCgpLmdldCkudG9CZURlZmluZWQoKVxuICAgIH0pXG5cbiAgICBpdCgnaGFzIGEgcmVnaXN0ZXIgZnVuY3Rpb24nLCAoKSA9PiB7XG4gICAgICBleHBlY3QobWFpbk1vZHVsZS5wcm92aWRlR29HZXQoKS5yZWdpc3RlcikudG9CZURlZmluZWQoKVxuICAgIH0pXG5cbiAgICBkZXNjcmliZSgncmVnaXN0ZXIoKScsICgpID0+IHtcbiAgICAgIGxldCBtYW5hZ2VyXG4gICAgICBsZXQgcHJvdmlkZXJcbiAgICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgICBwcm92aWRlciA9IG1haW5Nb2R1bGUucHJvdmlkZUdvR2V0KClcbiAgICAgICAgbWFuYWdlciA9IG1haW5Nb2R1bGUuZ2V0c2VydmljZS5nZXRtYW5hZ2VyXG4gICAgICAgIGV4cGVjdChtYW5hZ2VyKS50b0JlVHJ1dGh5KClcbiAgICAgICAgZXhwZWN0KG1hbmFnZXIucGFja2FnZXMpLnRvQmVUcnV0aHkoKVxuICAgICAgICBleHBlY3QobWFuYWdlci5wYWNrYWdlcy5zaXplKS50b0JlKDApXG4gICAgICB9KVxuXG4gICAgICBpdCgncmVnaXN0ZXJzIGEgcGFja2FnZScsICgpID0+IHtcbiAgICAgICAgcHJvdmlkZXIucmVnaXN0ZXIoJ2dpdGh1Yi5jb20vbWRlbXBza3kvZ29jb2RlJylcbiAgICAgICAgZXhwZWN0KG1hbmFnZXIucGFja2FnZXMuc2l6ZSkudG9CZSgxKVxuICAgICAgICBwcm92aWRlci5yZWdpc3RlcignZ2l0aHViLmNvbS9tZGVtcHNreS9nb2NvZGUnKVxuICAgICAgICBleHBlY3QobWFuYWdlci5wYWNrYWdlcy5zaXplKS50b0JlKDEpXG4gICAgICB9KVxuXG4gICAgICBpdCgncmVnaXN0ZXJzIHRoZSBzYW1lIHBhY2thZ2UgbXVsdGlwbGUgdGltZXMnLCAoKSA9PiB7XG4gICAgICAgIHByb3ZpZGVyLnJlZ2lzdGVyKCdnaXRodWIuY29tL21kZW1wc2t5L2dvY29kZScpXG4gICAgICAgIGV4cGVjdChtYW5hZ2VyLnBhY2thZ2VzLnNpemUpLnRvQmUoMSlcbiAgICAgICAgcHJvdmlkZXIucmVnaXN0ZXIoJ2dpdGh1Yi5jb20vbWRlbXBza3kvZ29jb2RlJylcbiAgICAgICAgZXhwZWN0KG1hbmFnZXIucGFja2FnZXMuc2l6ZSkudG9CZSgxKVxuICAgICAgICBwcm92aWRlci5yZWdpc3RlcignZ2l0aHViLmNvbS9tZGVtcHNreS9nb2NvZGUnKVxuICAgICAgICBleHBlY3QobWFuYWdlci5wYWNrYWdlcy5zaXplKS50b0JlKDEpXG4gICAgICB9KVxuXG4gICAgICBpdCgnYWxsb3dzIGEgcGFja2FnZSByZWdpc3RyYXRpb24gdG8gYmUgZGlzcG9zZWQnLCAoKSA9PiB7XG4gICAgICAgIGxldCByZWdpc3RyYXRpb24gPSBwcm92aWRlci5yZWdpc3RlcignZ2l0aHViLmNvbS9tZGVtcHNreS9nb2NvZGUnKVxuICAgICAgICBleHBlY3QocmVnaXN0cmF0aW9uKS50b0JlVHJ1dGh5KClcbiAgICAgICAgZXhwZWN0KHJlZ2lzdHJhdGlvbi5kaXNwb3NlKS50b0JlRGVmaW5lZCgpXG4gICAgICAgIGV4cGVjdChtYW5hZ2VyLnBhY2thZ2VzLnNpemUpLnRvQmUoMSlcbiAgICAgICAgcmVnaXN0cmF0aW9uLmRpc3Bvc2UoKVxuICAgICAgICBleHBlY3QobWFuYWdlci5wYWNrYWdlcy5zaXplKS50b0JlKDApXG4gICAgICB9KVxuXG4gICAgICBpdCgnZGlzcG9zZSBpcyBhd2FyZSBvZiB0aGUgbnVtYmVyIG9mIHBhY2thZ2UgcmVnaXN0cmF0aW9ucycsICgpID0+IHtcbiAgICAgICAgbGV0IHJlZ2lzdHJhdGlvbjEgPSBwcm92aWRlci5yZWdpc3RlcignZ2l0aHViLmNvbS9tZGVtcHNreS9nb2NvZGUnKVxuICAgICAgICBleHBlY3QocmVnaXN0cmF0aW9uMSkudG9CZVRydXRoeSgpXG4gICAgICAgIGV4cGVjdChyZWdpc3RyYXRpb24xLmRpc3Bvc2UpLnRvQmVEZWZpbmVkKClcbiAgICAgICAgZXhwZWN0KG1hbmFnZXIucGFja2FnZXMuc2l6ZSkudG9CZSgxKVxuICAgICAgICBsZXQgcmVnaXN0cmF0aW9uMiA9IHByb3ZpZGVyLnJlZ2lzdGVyKCdnaXRodWIuY29tL21kZW1wc2t5L2dvY29kZScpXG4gICAgICAgIGV4cGVjdChyZWdpc3RyYXRpb24yKS50b0JlVHJ1dGh5KClcbiAgICAgICAgZXhwZWN0KHJlZ2lzdHJhdGlvbjIuZGlzcG9zZSkudG9CZURlZmluZWQoKVxuICAgICAgICBleHBlY3QobWFuYWdlci5wYWNrYWdlcy5zaXplKS50b0JlKDEpXG4gICAgICAgIHJlZ2lzdHJhdGlvbjEuZGlzcG9zZSgpXG4gICAgICAgIGV4cGVjdChtYW5hZ2VyLnBhY2thZ2VzLnNpemUpLnRvQmUoMSlcbiAgICAgICAgcmVnaXN0cmF0aW9uMi5kaXNwb3NlKClcbiAgICAgICAgZXhwZWN0KG1hbmFnZXIucGFja2FnZXMuc2l6ZSkudG9CZSgwKVxuICAgICAgICByZWdpc3RyYXRpb24xLmRpc3Bvc2UoKVxuICAgICAgICByZWdpc3RyYXRpb24yLmRpc3Bvc2UoKVxuICAgICAgICBleHBlY3QobWFuYWdlci5wYWNrYWdlcy5zaXplKS50b0JlKDApXG4gICAgICB9KVxuICAgIH0pXG4gIH0pXG59KVxuIl19