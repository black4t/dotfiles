function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, "next"); var callThrow = step.bind(null, "throw"); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }

var _jasmineFix = require("jasmine-fix");

var _libRegistry = require("../lib/registry");

var _libRegistry2 = _interopRequireDefault(_libRegistry);

describe("Registry", function () {
  var registry = undefined;

  beforeEach(function () {
    registry = new _libRegistry2["default"]();
  });
  afterEach(function () {
    registry.dispose();
  });

  function validateTiles(actual, expected) {
    expect(actual.length).toBe(expected.length);

    actual.forEach(function (entry, index) {
      expect(entry.title).toBe(expected[index]);
    });
  }
  function validateOldTiles(oldTitles, titles) {
    expect(oldTitles.length).toBe(titles.length);

    titles.forEach(function (title, index) {
      expect(oldTitles[index].title).toBe(title);
      expect(oldTitles[index].duration === "1ms" || oldTitles[index].duration === "0ms").toBe(true);
    });
  }

  describe("handling of providers", function () {
    (0, _jasmineFix.it)("registers providers properly and clears them out when they die", function () {
      var provider = registry.create();
      expect(registry.providers.has(provider)).toBe(true);
      provider.dispose();
      expect(registry.providers.has(provider)).toBe(false);
    });
    (0, _jasmineFix.it)("emits update event properly", function () {
      var provider = registry.create();
      var update = jasmine.createSpy("update");
      registry.onDidUpdate(update);
      expect(update).not.toHaveBeenCalled();
      provider.add("Hey");
      provider.remove("Hey");
      provider.clear();
      expect(update).toHaveBeenCalled();
      expect(update.calls.length).toBe(2);
    });
    (0, _jasmineFix.it)("adds and returns sorted titles", _asyncToGenerator(function* () {
      var provider = registry.create();
      provider.add("Hey");
      yield (0, _jasmineFix.wait)(1);
      provider.add("Wow");
      yield (0, _jasmineFix.wait)(1);
      provider.add("Hello");
      validateTiles(registry.getTilesActive(), ["Hello", "Wow", "Hey"]);
    }));
    (0, _jasmineFix.it)("adds removed ones to history", _asyncToGenerator(function* () {
      var provider = registry.create();
      provider.add("Boy");
      yield (0, _jasmineFix.wait)(1);
      provider.add("Hey");
      validateTiles(registry.getTilesActive(), ["Hey", "Boy"]);
      expect(registry.getTilesOld()).toEqual([]);

      provider.remove("Hey");
      validateTiles(registry.getTilesActive(), ["Boy"]);
      validateOldTiles(registry.getTilesOld(), ["Hey"]);
    }));
    (0, _jasmineFix.it)("adds cleared ones to history", function () {
      var provider = registry.create();
      provider.add("Hello");
      provider.add("World");

      validateTiles(registry.getTilesActive(), ["Hello", "World"]);
      expect(registry.getTilesOld()).toEqual([]);

      provider.clear();
      validateTiles(registry.getTilesActive(), []);
      validateOldTiles(registry.getTilesOld(), ["Hello", "World"]);
    });
  });
  describe("getTilesOld", function () {
    (0, _jasmineFix.it)("excludes active ones from history", function () {
      var provider = registry.create();
      provider.add("Yo CJ");
      provider.add("Murica");
      provider.remove("Yo CJ");
      provider.remove("Murica");
      provider.add("Yo CJ");

      validateOldTiles(registry.getTilesOld(), ["Murica"]);
    });
    (0, _jasmineFix.it)("excludes duplicates and only returns the last one", function () {
      var provider = registry.create();

      provider.add("Some");
      provider.add("Things");
      provider.remove("Some");
      provider.remove("Things");
      provider.add("Some");
      provider.remove("Some");

      validateOldTiles(registry.getTilesOld(), ["Things", "Some"]);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL215dWdhLy5hdG9tL3BhY2thZ2VzL2J1c3ktc2lnbmFsL3NwZWMvcmVnaXN0cnktc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OzBCQUV5QixhQUFhOzsyQkFDakIsaUJBQWlCOzs7O0FBR3RDLFFBQVEsQ0FBQyxVQUFVLEVBQUUsWUFBVztBQUM5QixNQUFJLFFBQVEsWUFBQSxDQUFDOztBQUViLFlBQVUsQ0FBQyxZQUFXO0FBQ3BCLFlBQVEsR0FBRyw4QkFBYyxDQUFDO0dBQzNCLENBQUMsQ0FBQztBQUNILFdBQVMsQ0FBQyxZQUFXO0FBQ25CLFlBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztHQUNwQixDQUFDLENBQUM7O0FBRUgsV0FBUyxhQUFhLENBQ3BCLE1BQTZCLEVBQzdCLFFBQXVCLEVBQ3ZCO0FBQ0EsVUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDOztBQUU1QyxVQUFNLENBQUMsT0FBTyxDQUFDLFVBQUMsS0FBSyxFQUFFLEtBQUssRUFBSztBQUMvQixZQUFNLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQztLQUMzQyxDQUFDLENBQUM7R0FDSjtBQUNELFdBQVMsZ0JBQWdCLENBQ3ZCLFNBQXFELEVBQ3JELE1BQXFCLEVBQ3JCO0FBQ0EsVUFBTSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDOztBQUU3QyxVQUFNLENBQUMsT0FBTyxDQUFDLFVBQVMsS0FBSyxFQUFFLEtBQUssRUFBRTtBQUNwQyxZQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUMzQyxZQUFNLENBQ0osU0FBUyxDQUFDLEtBQUssQ0FBQyxD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LENBQUMsQ0FBQyxDQUFDO0tBQ3RELENBQUMsQ0FBQztBQUNILHdCQUFHLG1EQUFtRCxFQUFFLFlBQVc7QUFDakUsVUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDOztBQUVuQyxjQUFRLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQ3JCLGNBQVEsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7QUFDdkIsY0FBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUN4QixjQUFRLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQzFCLGNBQVEsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDckIsY0FBUSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQzs7QUFFeEIsc0JBQWdCLENBQUMsUUFBUSxDQUFDLFdBQVcsRUFBRSxFQUFFLENBQUMsUUFBUSxFQUFFLE1BQU0sQ0FBQyxDQUFDLENBQUM7S0FDOUQsQ0FBQyxDQUFDO0dBQ0osQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDIiwiZmlsZSI6Ii9ob21lL215dWdhLy5hdG9tL3BhY2thZ2VzL2J1c3ktc2lnbmFsL3NwZWMvcmVnaXN0cnktc3BlYy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cbmltcG9ydCB7IGl0LCB3YWl0IH0gZnJvbSBcImphc21pbmUtZml4XCI7XG5pbXBvcnQgUmVnaXN0cnkgZnJvbSBcIi4uL2xpYi9yZWdpc3RyeVwiO1xuaW1wb3J0IHR5cGUgeyBTaWduYWxJbnRlcm5hbCB9IGZyb20gXCIuLi9saWIvdHlwZXNcIjtcblxuZGVzY3JpYmUoXCJSZWdpc3RyeVwiLCBmdW5jdGlvbigpIHtcbiAgbGV0IHJlZ2lzdHJ5O1xuXG4gIGJlZm9yZUVhY2goZnVuY3Rpb24oKSB7XG4gICAgcmVnaXN0cnkgPSBuZXcgUmVnaXN0cnkoKTtcbiAgfSk7XG4gIGFmdGVyRWFjaChmdW5jdGlvbigpIHtcbiAgICByZWdpc3RyeS5kaXNwb3NlKCk7XG4gIH0pO1xuXG4gIGZ1bmN0aW9uIHZhbGlkYXRlVGlsZXMoXG4gICAgYWN0dWFsOiBBcnJheTxTaWduYWxJbnRlcm5hbD4sXG4gICAgZXhwZWN0ZWQ6IEFycmF5PHN0cmluZz5cbiAgKSB7XG4gICAgZXhwZWN0KGFjdHVhbC5sZW5ndGgpLnRvQmUoZXhwZWN0ZWQubGVuZ3RoKTtcblxuICAgIGFjdHVhbC5mb3JFYWNoKChlbnRyeSwgaW5kZXgpID0+IHtcbiAgICAgIGV4cGVjdChlbnRyeS50aXRsZSkudG9CZShleHBlY3RlZFtpbmRleF0pO1xuICAgIH0pO1xuICB9XG4gIGZ1bmN0aW9uIHZhbGlkYXRlT2xkVGlsZXMoXG4gICAgb2xkVGl0bGVzOiBBcnJheTx7IHRpdGxlOiBzdHJpbmcsIGR1cmF0aW9uOiBzdHJpbmcgfT4sXG4gICAgdGl0bGVzOiBBcnJheTxzdHJpbmc+XG4gICkge1xuICAgIGV4cGVjdChvbGRUaXRsZXMubGVuZ3RoKS50b0JlKHRpdGxlcy5sZW5ndGgpO1xuXG4gICAgdGl0bGVzLmZvckVhY2goZnVuY3Rpb24odGl0bGUsIGluZGV4KSB7XG4gICAgICBleHBlY3Qob2xkVGl0bGVzW2luZGV4XS50aXRsZSkudG9CZSh0aXRsZSk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIG9sZFRpdGxlc1tpbmRleF0uZHVyYXRpb24gPT09IFwiMW1zXCIgfHxcbiAgICAgICAgICBvbGRUaXRsZXNbaW5kZXhdLmR1cmF0aW9uID09PSBcIjBtc1wiXG4gICAgICApLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG4gIH1cblxuICBkZXNjcmliZShcImhhbmRsaW5nIG9mIHByb3ZpZGVyc1wiLCBmdW5jdGlvbigpIHtcbiAgICBpdChcInJlZ2lzdGVycyBwcm92aWRlcnMgcHJvcGVybHkgYW5kIGNsZWFycyB0aGVtIG91dCB3aGVuIHRoZXkgZGllXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSByZWdpc3RyeS5jcmVhdGUoKTtcbiAgICAgIGV4cGVjdChyZWdpc3RyeS5wcm92aWRlcnMuaGFzKHByb3ZpZGVyKSkudG9CZSh0cnVlKTtcbiAgICAgIHByb3ZpZGVyLmRpc3Bvc2UoKTtcbiAgICAgIGV4cGVjdChyZWdpc3RyeS5wcm92aWRlcnMuaGFzKHByb3ZpZGVyKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gICAgaXQoXCJlbWl0cyB1cGRhdGUgZXZlbnQgcHJvcGVybHlcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IHJlZ2lzdHJ5LmNyZWF0ZSgpO1xuICAgICAgY29uc3QgdXBkYXRlID0gamFzbWluZS5jcmVhdGVTcHkoXCJ1cGRhdGVcIik7XG4gICAgICByZWdpc3RyeS5vbkRpZFVwZGF0ZSh1cGRhdGUpO1xuICAgICAgZXhwZWN0KHVwZGF0ZSkubm90LnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIHByb3ZpZGVyLmFkZChcIkhleVwiKTtcbiAgICAgIHByb3ZpZGVyLnJlbW92ZShcIkhleVwiKTtcbiAgICAgIHByb3ZpZGVyLmNsZWFyKCk7XG4gICAgICBleHBlY3QodXBkYXRlKS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICBleHBlY3QodXBkYXRlLmNhbGxzLmxlbmd0aCkudG9CZSgyKTtcbiAgICB9KTtcbiAgICBpdChcImFkZHMgYW5kIHJldHVybnMgc29ydGVkIHRpdGxlc1wiLCBhc3luYyBmdW5jdGlvbigpIHtcbiAgICAgIGNvbnN0IHByb3ZpZGVyID0gcmVnaXN0cnkuY3JlYXRlKCk7XG4gICAgICBwcm92aWRlci5hZGQoXCJIZXlcIik7XG4gICAgICBhd2FpdCB3YWl0KDEpO1xuICAgICAgcHJvdmlkZXIuYWRkKFwiV293XCIpO1xuICAgICAgYXdhaXQgd2FpdCgxKTtcbiAgICAgIHByb3ZpZGVyLmFkZChcIkhlbGxvXCIpO1xuICAgICAgdmFsaWRhdGVUaWxlcyhyZWdpc3RyeS5nZXRUaWxlc0FjdGl2ZSgpLCBbXCJIZWxsb1wiLCBcIldvd1wiLCBcIkhleVwiXSk7XG4gICAgfSk7XG4gICAgaXQoXCJhZGRzIHJlbW92ZWQgb25lcyB0byBoaXN0b3J5XCIsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSByZWdpc3RyeS5jcmVhdGUoKTtcbiAgICAgIHByb3ZpZGVyLmFkZChcIkJveVwiKTtcbiAgICAgIGF3YWl0IHdhaXQoMSk7XG4gICAgICBwcm92aWRlci5hZGQoXCJIZXlcIik7XG4gICAgICB2YWxpZGF0ZVRpbGVzKHJlZ2lzdHJ5LmdldFRpbGVzQWN0aXZlKCksIFtcIkhleVwiLCBcIkJveVwiXSk7XG4gICAgICBleHBlY3QocmVnaXN0cnkuZ2V0VGlsZXNPbGQoKSkudG9FcXVhbChbXSk7XG5cbiAgICAgIHByb3ZpZGVyLnJlbW92ZShcIkhleVwiKTtcbiAgICAgIHZhbGlkYXRlVGlsZXMocmVnaXN0cnkuZ2V0VGlsZXNBY3RpdmUoKSwgW1wiQm95XCJdKTtcbiAgICAgIHZhbGlkYXRlT2xkVGlsZXMocmVnaXN0cnkuZ2V0VGlsZXNPbGQoKSwgW1wiSGV5XCJdKTtcbiAgICB9KTtcbiAgICBpdChcImFkZHMgY2xlYXJlZCBvbmVzIHRvIGhpc3RvcnlcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IHJlZ2lzdHJ5LmNyZWF0ZSgpO1xuICAgICAgcHJvdmlkZXIuYWRkKFwiSGVsbG9cIik7XG4gICAgICBwcm92aWRlci5hZGQoXCJXb3JsZFwiKTtcblxuICAgICAgdmFsaWRhdGVUaWxlcyhyZWdpc3RyeS5nZXRUaWxlc0FjdGl2ZSgpLCBbXCJIZWxsb1wiLCBcIldvcmxkXCJdKTtcbiAgICAgIGV4cGVjdChyZWdpc3RyeS5nZXRUaWxlc09sZCgpKS50b0VxdWFsKFtdKTtcblxuICAgICAgcHJvdmlkZXIuY2xlYXIoKTtcbiAgICAgIHZhbGlkYXRlVGlsZXMocmVnaXN0cnkuZ2V0VGlsZXNBY3RpdmUoKSwgW10pO1xuICAgICAgdmFsaWRhdGVPbGRUaWxlcyhyZWdpc3RyeS5nZXRUaWxlc09sZCgpLCBbXCJIZWxsb1wiLCBcIldvcmxkXCJdKTtcbiAgICB9KTtcbiAgfSk7XG4gIGRlc2NyaWJlKFwiZ2V0VGlsZXNPbGRcIiwgZnVuY3Rpb24oKSB7XG4gICAgaXQoXCJleGNsdWRlcyBhY3RpdmUgb25lcyBmcm9tIGhpc3RvcnlcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IHJlZ2lzdHJ5LmNyZWF0ZSgpO1xuICAgICAgcHJvdmlkZXIuYWRkKFwiWW8gQ0pcIik7XG4gICAgICBwcm92aWRlci5hZGQoXCJNdXJpY2FcIik7XG4gICAgICBwcm92aWRlci5yZW1vdmUoXCJZbyBDSlwiKTtcbiAgICAgIHByb3ZpZGVyLnJlbW92ZShcIk11cmljYVwiKTtcbiAgICAgIHByb3ZpZGVyLmFkZChcIllvIENKXCIpO1xuXG4gICAgICB2YWxpZGF0ZU9sZFRpbGVzKHJlZ2lzdHJ5LmdldFRpbGVzT2xkKCksIFtcIk11cmljYVwiXSk7XG4gICAgfSk7XG4gICAgaXQoXCJleGNsdWRlcyBkdXBsaWNhdGVzIGFuZCBvbmx5IHJldHVybnMgdGhlIGxhc3Qgb25lXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSByZWdpc3RyeS5jcmVhdGUoKTtcblxuICAgICAgcHJvdmlkZXIuYWRkKFwiU29tZVwiKTtcbiAgICAgIHByb3ZpZGVyLmFkZChcIlRoaW5nc1wiKTtcbiAgICAgIHByb3ZpZGVyLnJlbW92ZShcIlNvbWVcIik7XG4gICAgICBwcm92aWRlci5yZW1vdmUoXCJUaGluZ3NcIik7XG4gICAgICBwcm92aWRlci5hZGQoXCJTb21lXCIpO1xuICAgICAgcHJvdmlkZXIucmVtb3ZlKFwiU29tZVwiKTtcblxuICAgICAgdmFsaWRhdGVPbGRUaWxlcyhyZWdpc3RyeS5nZXRUaWxlc09sZCgpLCBbXCJUaGluZ3NcIiwgXCJTb21lXCJdKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdfQ==