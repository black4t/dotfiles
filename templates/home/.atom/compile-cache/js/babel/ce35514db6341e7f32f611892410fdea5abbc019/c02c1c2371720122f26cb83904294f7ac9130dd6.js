function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }

function _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }

/* eslint-env jasmine */

var _libConfigExecutor = require('./../../lib/config/executor');

var _libConfigPathhelper = require('./../../lib/config/pathhelper');

var pathhelper = _interopRequireWildcard(_libConfigPathhelper);

var _os = require('os');

var _os2 = _interopRequireDefault(_os);

var _path = require('path');

var _path2 = _interopRequireDefault(_path);

var _specHelpers = require('./../spec-helpers');

var _asyncSpecHelpers = require('../async-spec-helpers');

// eslint-disable-line

'use babel';describe('executor', function () {
  var executor = null;
  var prefix = null;

  (0, _asyncSpecHelpers.beforeEach)(function () {
    _specHelpers.lifecycle.setup();
    prefix = '/';
    if (_os2['default'].platform() === 'win32') {
      prefix = 'C:\\';
    }
    executor = new _libConfigExecutor.Executor();
  });

  describe('when asynchronously executing a command', function () {
    (0, _asyncSpecHelpers.it)('succeeds', _asyncToGenerator(function* () {
      var command = 'env';
      if (_os2['default'].platform() === 'win32') {
        command = _path2['default'].resolve(__dirname, 'tools', 'env', 'env_windows_amd64.exe');
      }

      var result = yield executor.exec(command, [], { cwd: prefix });
      expect(result).toBeDefined();
      expect(result.exitcode).toBeDefined();
      expect(result.exitcode).toBe(0);
      expect(result.stdout).toBeDefined();
      expect(result.stdout).not.toBe('');
      expect(result.stderr).toBeDefined();
      expect(result.stderr).toBe('');
      expect(result.error).toBeFalsy();
    }));

    (0, _asyncSpecHelpers.it)('sets the working directory correctly', _asyncToGenerator(function* () {
      var command = 'pwd';
      if (_os2['default'].platform() === 'win32') {
        command = _path2['default'].resolve(__dirname, 'tools', 'pwd', 'pwd_windows_amd64.exe');
      }

      var result = yield executor.exec(command, [], {
        cwd: pathhelper.home()
      });
      expect(result).toBeDefined();
      expect(result.exitcode).toBeDefined();
      expect(result.exitcode).toBe(0);
      expect(result.stdout).toBeDefined();
      expect(result.stdout).toBe(pathhelper.home() + '\n');
      expect(result.stderr).toBeDefined();
      expect(result.stderr).toBe('');
      expect(result.error).toBeFalsy();
    }));

    (0, _asyncSpecHelpers.it)('sets the environment correctly', _asyncToGenerator(function* () {
      var command = 'env';
      if (_os2['default'].platform() === 'win32') {
        command = _path2['default'].resolve(__dirname, 'tools', 'env', 'env_windows_amd64.exe');
      }
      var env = { testenv: 'testing' };
      var result = yield executor.exec(command, [], { env: env });

      expect(result).toBeDefined();
      expect(result.exitcode).toBeDefined();
      expect(result.exitcode).toBe(0);
      expect(result.stdout).toBeDefined();
      expect(result.stdout).toContain('testenv=testing\n');
      expect(result.stderr).toBeDefined();
      expect(result.stderr).toBe('');
      expect(result.error).toBeFalsy();
    }));

    (0, _asyncSpecHelpers.it)('handles and returns an ENOENT error if the command was not found', _asyncToGenerator(function* () {
      var result = yield executor.exec('nonexistentcommand', [], executor.getOptions());
      expect(result).toBeTruthy();
      expect(result.error).toBeTruthy();
      expect(result.error.errno).toBe('ENOENT');
      expect(result.error.message).toBe('spawn nonexistentcommand ENOENT');
      expect(result.error.path).toBe('nonexistentcommand');
      expect(result.exitcode).toBe(127);
      expect(result.stdout).toBe('');
      expect(result.stderr).toBeDefined();
      if (_os2['default'].platform() === 'win32') {
        expect(result.stderr).toBe("'nonexistentcommand' is not recognized as an internal or external command,\r\noperable program or batch file.\r\n");
      } else {
        expect(result.stderr).toBe('');
      }
    }));
  });

  describe('when synchronously executing a command', function () {
    (0, _asyncSpecHelpers.it)('succeeds', function () {
      var command = 'env';
      if (_os2['default'].platform() === 'win32') {
        command = _path2['default'].resolve(__dirname, 'tools', 'env', 'env_windows_amd64.exe');
      }

      var result = executor.execSync(command, [], executor.getOptions());
      expect(result.exitcode).toBeDefined();
      expect(result.exitcode).toBe(0);
      expect(result.stdout).toBeDefined();
      expect(result.stdout).not.toBe('');
      expect(result.stderr).toBeDefined();
      expect(result.stderr).toBe('');
      expect(result.error).toBeFalsy();
    });

    (0, _asyncSpecHelpers.it)('returns a message if the command was not found', function () {
      var result = executor.execSync('nonexistentcommand', [], executor.getOptions());
      expect(result.exitcode).toBeDefined();
      expect(result.exitcode).toBe(127);
      expect(result.stdout).toBeDefined();
      expect(result.stdout).toBe('');
      expect(result.stderr).toBeDefined();
      expect(result.stderr).toBe('');
      expect(result.error).toBeTruthy();
      expect(result.error.code).toBe('ENOENT');
      expect(result.error.errno).toBe('ENOENT');
      expect(result.error.message).toBe('spawnSync nonexistentcommand ENOENT');
      expect(result.error.path).toBe('nonexistentcommand');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL215dWdhLy5hdG9tL3BhY2thZ2VzL2dvLXBsdXMvc3BlYy9jb25maWcvZXhlY3V0b3Itc3BlYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7OztpQ0FHeUIsNkJBQTZCOzttQ0FDMUIsK0JBQStCOztJQUEvQyxVQUFVOztrQkFDUCxJQUFJOzs7O29CQUNGLE1BQU07Ozs7MkJBQ0csbUJBQW1COztnQ0FDRyx1QkFBdUI7Ozs7QUFSdkUsV0FBVyxDQUFBLEFBVVgsUUFBUSxDQUFDLFVBQVUsRUFBRSxZQUFNO0FBQ3pCLE1BQUksUUFBUSxHQUFHLElBQUksQ0FBQTtBQUNuQixNQUFJLE1BQU0sR0FBRyxJQUFJLENBQUE7O0FBRWpCLG9DQUFXLFlBQU07QUFDZiwyQkFBVSxLQUFLLEVBQUUsQ0FBQTtBQUNqQixVQUFNLEdBQUcsR0FBRyxDQUFBO0FBQ1osUUFBSSxnQkFBRyxRQUFRLEVBQUUsS0FBSyxPQUFPLEVBQUU7QUFDN0IsWUFBTSxHQUFHLE1BQU0sQ0FBQTtLQUNoQjtBQUNELFlBQVEsR0FBRyxpQ0FBYyxDQUFBO0dBQzFCLENBQUMsQ0FBQTs7QUFFRixVQUFRLENBQUMseUNBQXlDLEVBQUUsWUFBTTtBQUN4RCw4QkFBRyxVQUFVLG9CQUFFLGFBQVk7QUFDekIsVUFBSSxPQUFPLEdBQUcsS0FBSyxDQUFBO0FBQ25CLFVBQUksZ0JBQUcsUUFBUSxFQUFFLEtBQUssT0FBTyxFQUFFO0FBQzdCLGVBQU8sR0FBRyxrQkFBSyxPQUFPLENBQ3BCLFNBQVMsRUFDVCxPQUFPLEVBQ1AsS0FBSyxFQUNMLHVCQUF1QixDQUN4QixDQUFBO09BQ0Y7O0FBRUQsVUFBTSxNQUFNLEdBQUcsTUFBTSxRQUFRLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQTtBQUNoRSxZQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUE7QUFDNUIsWUFBTSxDQUFDLE1B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TSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsb0JBQW9CLENBQUMsQ0FBQTtLQUNyRCxDQUFDLENBQUE7R0FDSCxDQUFDLENBQUE7Q0FDSCxDQUFDLENBQUEiLCJmaWxlIjoiL2hvbWUvbXl1Z2EvLmF0b20vcGFja2FnZXMvZ28tcGx1cy9zcGVjL2NvbmZpZy9leGVjdXRvci1zcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCdcbi8qIGVzbGludC1lbnYgamFzbWluZSAqL1xuXG5pbXBvcnQgeyBFeGVjdXRvciB9IGZyb20gJy4vLi4vLi4vbGliL2NvbmZpZy9leGVjdXRvcidcbmltcG9ydCAqIGFzIHBhdGhoZWxwZXIgZnJvbSAnLi8uLi8uLi9saWIvY29uZmlnL3BhdGhoZWxwZXInXG5pbXBvcnQgb3MgZnJvbSAnb3MnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IHsgbGlmZWN5Y2xlIH0gZnJvbSAnLi8uLi9zcGVjLWhlbHBlcnMnXG5pbXBvcnQgeyBpdCwgZml0LCBmZml0LCBiZWZvcmVFYWNoLCBydW5zIH0gZnJvbSAnLi4vYXN5bmMtc3BlYy1oZWxwZXJzJyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG5cbmRlc2NyaWJlKCdleGVjdXRvcicsICgpID0+IHtcbiAgbGV0IGV4ZWN1dG9yID0gbnVsbFxuICBsZXQgcHJlZml4ID0gbnVsbFxuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGxpZmVjeWNsZS5zZXR1cCgpXG4gICAgcHJlZml4ID0gJy8nXG4gICAgaWYgKG9zLnBsYXRmb3JtKCkgPT09ICd3aW4zMicpIHtcbiAgICAgIHByZWZpeCA9ICdDOlxcXFwnXG4gICAgfVxuICAgIGV4ZWN1dG9yID0gbmV3IEV4ZWN1dG9yKClcbiAgfSlcblxuICBkZXNjcmliZSgnd2hlbiBhc3luY2hyb25vdXNseSBleGVjdXRpbmcgYSBjb21tYW5kJywgKCkgPT4ge1xuICAgIGl0KCdzdWNjZWVkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBjb21tYW5kID0gJ2VudidcbiAgICAgIGlmIChvcy5wbGF0Zm9ybSgpID09PSAnd2luMzInKSB7XG4gICAgICAgIGNvbW1hbmQgPSBwYXRoLnJlc29sdmUoXG4gICAgICAgICAgX19kaXJuYW1lLFxuICAgICAgICAgICd0b29scycsXG4gICAgICAgICAgJ2VudicsXG4gICAgICAgICAgJ2Vudl93aW5kb3dzX2FtZDY0LmV4ZSdcbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRvci5leGVjKGNvbW1hbmQsIFtdLCB7IGN3ZDogcHJlZml4IH0pXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlKDApXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZG91dCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGRvdXQpLm5vdC50b0JlKCcnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGRlcnIpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RkZXJyKS50b0JlKCcnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZUZhbHN5KClcbiAgICB9KVxuXG4gICAgaXQoJ3NldHMgdGhlIHdvcmtpbmcgZGlyZWN0b3J5IGNvcnJlY3RseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGxldCBjb21tYW5kID0gJ3B3ZCdcbiAgICAgIGlmIChvcy5wbGF0Zm9ybSgpID09PSAnd2luMzInKSB7XG4gICAgICAgIGNvbW1hbmQgPSBwYXRoLnJlc29sdmUoXG4gICAgICAgICAgX19kaXJuYW1lLFxuICAgICAgICAgICd0b29scycsXG4gICAgICAgICAgJ3B3ZCcsXG4gICAgICAgICAgJ3B3ZF93aW5kb3dzX2FtZDY0LmV4ZSdcbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRvci5leGVjKGNvbW1hbmQsIFtdLCB7XG4gICAgICAgIGN3ZDogcGF0aGhlbHBlci5ob21lKClcbiAgICAgIH0pXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlKDApXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZG91dCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGRvdXQpLnRvQmUocGF0aGhlbHBlci5ob21lKCkgKyAnXFxuJylcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RkZXJyKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZGVycikudG9CZSgnJylcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVGYWxzeSgpXG4gICAgfSlcblxuICAgIGl0KCdzZXRzIHRoZSBlbnZpcm9ubWVudCBjb3JyZWN0bHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBsZXQgY29tbWFuZCA9ICdlbnYnXG4gICAgICBpZiAob3MucGxhdGZvcm0oKSA9PT0gJ3dpbjMyJykge1xuICAgICAgICBjb21tYW5kID0gcGF0aC5yZXNvbHZlKFxuICAgICAgICAgIF9fZGlybmFtZSxcbiAgICAgICAgICAndG9vbHMnLFxuICAgICAgICAgICdlbnYnLFxuICAgICAgICAgICdlbnZfd2luZG93c19hbWQ2NC5leGUnXG4gICAgICAgIClcbiAgICAgIH1cbiAgICAgIGxldCBlbnYgPSB7IHRlc3RlbnY6ICd0ZXN0aW5nJyB9XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBleGVjdXRvci5leGVjKGNvbW1hbmQsIFtdLCB7IGVudiB9KVxuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlKDApXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZG91dCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGRvdXQpLnRvQ29udGFpbigndGVzdGVudj10ZXN0aW5nXFxuJylcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RkZXJyKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZGVycikudG9CZSgnJylcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVGYWxzeSgpXG4gICAgfSlcblxuICAgIGl0KCdoYW5kbGVzIGFuZCByZXR1cm5zIGFuIEVOT0VOVCBlcnJvciBpZiB0aGUgY29tbWFuZCB3YXMgbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZXhlY3V0b3IuZXhlYyhcbiAgICAgICAgJ25vbmV4aXN0ZW50Y29tbWFuZCcsXG4gICAgICAgIFtdLFxuICAgICAgICBleGVjdXRvci5nZXRPcHRpb25zKClcbiAgICAgIClcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvQmVUcnV0aHkoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZVRydXRoeSgpXG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yLmVycm5vKS50b0JlKCdFTk9FTlQnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5tZXNzYWdlKS50b0JlKCdzcGF3biBub25leGlzdGVudGNvbW1hbmQgRU5PRU5UJylcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IucGF0aCkudG9CZSgnbm9uZXhpc3RlbnRjb21tYW5kJylcbiAgICAgIGV4cGVjdChyZXN1bHQuZXhpdGNvZGUpLnRvQmUoMTI3KVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGRvdXQpLnRvQmUoJycpXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZGVycikudG9CZURlZmluZWQoKVxuICAgICAgaWYgKG9zLnBsYXRmb3JtKCkgPT09ICd3aW4zMicpIHtcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdGRlcnIpLnRvQmUoXG4gICAgICAgICAgXCInbm9uZXhpc3RlbnRjb21tYW5kJyBpcyBub3QgcmVjb2duaXplZCBhcyBhbiBpbnRlcm5hbCBvciBleHRlcm5hbCBjb21tYW5kLFxcclxcbm9wZXJhYmxlIHByb2dyYW0gb3IgYmF0Y2ggZmlsZS5cXHJcXG5cIlxuICAgICAgICApXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBleHBlY3QocmVzdWx0LnN0ZGVycikudG9CZSgnJylcbiAgICAgIH1cbiAgICB9KVxuICB9KVxuXG4gIGRlc2NyaWJlKCd3aGVuIHN5bmNocm9ub3VzbHkgZXhlY3V0aW5nIGEgY29tbWFuZCcsICgpID0+IHtcbiAgICBpdCgnc3VjY2VlZHMnLCAoKSA9PiB7XG4gICAgICBsZXQgY29tbWFuZCA9ICdlbnYnXG4gICAgICBpZiAob3MucGxhdGZvcm0oKSA9PT0gJ3dpbjMyJykge1xuICAgICAgICBjb21tYW5kID0gcGF0aC5yZXNvbHZlKFxuICAgICAgICAgIF9fZGlybmFtZSxcbiAgICAgICAgICAndG9vbHMnLFxuICAgICAgICAgICdlbnYnLFxuICAgICAgICAgICdlbnZfd2luZG93c19hbWQ2NC5leGUnXG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgbGV0IHJlc3VsdCA9IGV4ZWN1dG9yLmV4ZWNTeW5jKGNvbW1hbmQsIFtdLCBleGVjdXRvci5nZXRPcHRpb25zKCkpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlKDApXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZG91dCkudG9CZURlZmluZWQoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGRvdXQpLm5vdC50b0JlKCcnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGRlcnIpLnRvQmVEZWZpbmVkKClcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RkZXJyKS50b0JlKCcnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZUZhbHN5KClcbiAgICB9KVxuXG4gICAgaXQoJ3JldHVybnMgYSBtZXNzYWdlIGlmIHRoZSBjb21tYW5kIHdhcyBub3QgZm91bmQnLCAoKSA9PiB7XG4gICAgICBsZXQgcmVzdWx0ID0gZXhlY3V0b3IuZXhlY1N5bmMoXG4gICAgICAgICdub25leGlzdGVudGNvbW1hbmQnLFxuICAgICAgICBbXSxcbiAgICAgICAgZXhlY3V0b3IuZ2V0T3B0aW9ucygpXG4gICAgICApXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LmV4aXRjb2RlKS50b0JlKDEyNylcbiAgICAgIGV4cGVjdChyZXN1bHQuc3Rkb3V0KS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZG91dCkudG9CZSgnJylcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RkZXJyKS50b0JlRGVmaW5lZCgpXG4gICAgICBleHBlY3QocmVzdWx0LnN0ZGVycikudG9CZSgnJylcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVUcnV0aHkoKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5jb2RlKS50b0JlKCdFTk9FTlQnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5lcnJubykudG9CZSgnRU5PRU5UJylcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IubWVzc2FnZSkudG9CZSgnc3Bhd25TeW5jIG5vbmV4aXN0ZW50Y29tbWFuZCBFTk9FTlQnKVxuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvci5wYXRoKS50b0JlKCdub25leGlzdGVudGNvbW1hbmQnKVxuICAgIH0pXG4gIH0pXG59KVxuIl19