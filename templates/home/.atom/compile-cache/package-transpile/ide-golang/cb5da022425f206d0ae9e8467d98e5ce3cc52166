"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const utils = require("./utils");
class GoOutline {
    constructor(core) {
        this.core = core;
    }
    getOutline(editor) {
        return new Promise((resolve, _) => {
            this.core.spawn("go-outline", ["-f=" + editor.getPath(), "-modified"], {
                cwd: utils.getDirname(editor),
                input: utils.getFileArchive(editor),
            }).then((out) => {
                const results = JSON.parse(out);
                resolve({
                    outlineTrees: results.map((outline) => utils.goOutlineToAtomOutline(editor, outline)),
                });
            }).catch((err) => {
                this.core.logWarn(err);
                resolve(null);
            });
        });
    }
}
exports.GoOutline = GoOutline;
